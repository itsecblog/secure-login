<html>

<meta http-equiv="Content-Type" content="text/html;charset=windows-1252" >

<head>

	<script src="bCrypt.js" type="text/javascript"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>

	<script type="text/javascript">

	var salt = "";

	function result(hash){	  
		$("#password").val(hash);
	  	$("#pwdForm").submit();
	}

	function getSalt()
	{

		$salt = "";

		ajax = new XMLHttpRequest();
    		if(ajax!=null)
		{
			ajax.open("POST","./salt.php",true);
			ajax.onreadystatechange = function()
			{
				if(this.readyState == 4)
				{
					if(this.status == 200)
					{
						if(this.responseText != '')
						{
							$salt = this.responseText;	
							login();
						}
					}
				}
			
			}
			var postdata= 'username='+$("#username").val();

			ajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			ajax.setRequestHeader("Content-length", postdata.length);

			ajax.send(postdata);
		}
    		else
		{
			alert("Ihr Browser unterstützt kein Ajax!");
    		}
	}

	function login()
	{
	
		// Weitere Checks ausführen
	
		try
		{
			hashpw($("#password").val(), $salt, result);
		} 
		catch(err) 
		{
	    		alert(err);
	    		return;
		}

	}

	</script>

</head>
<body>
	
	<h1>Login</h1>
	<br />	

	<form id='pwdForm' action='./do-login.php' method='post'>
		<label for="username">Username: </label><input size=30 type="text" name="username" id="username"></input>
		<br />
		<label for="password">Password: </label><input size=30 type="password" name="password" id="password"></input>
		<br />	<br />		
		<INPUT TYPE="button" value="Login" onClick="getSalt()"/>
	</form>

	<br />	
	<br />	
<a href="./register.html">Registrieren</a>


</body>
</html>
